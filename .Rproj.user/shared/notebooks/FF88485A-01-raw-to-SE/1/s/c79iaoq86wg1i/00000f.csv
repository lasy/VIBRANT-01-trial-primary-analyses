"0",""
"0","mg_to_SE <- function(mg, mg_manifest, LBP_strain_info){"
"0","  mg_manifest <- "
"0","    mg_manifest |> "
"0","    mutate(sample_id = str_c(pid, ""_"", visit_code))"
"0","  "
"0","  if (any(duplicated(mg_manifest$sample_id))) stop(""Duplicated `uid` in `mg_manifest`"")"
"0","  "
"0","  mg <- mg |> left_join(mg_manifest, by = join_by(barcode))"
"0","  tmp <- mg |> select(barcode, sample_id) |> distinct()"
"0","  if (any(duplicated(tmp$sample_id))) stop(""Duplicated `uid` in `mg`"")"
"0","  "
"0","  assay_prop_of_Lc <- "
"0","    mg |> "
"0","    select(sample_id, strain, prop_of_Lc) |> "
"0","    pivot_wider(names_from = sample_id, values_from = prop_of_Lc) |> "
"0","    as.data.frame() |> "
"0","    column_to_rownames(""strain"") "
"0","    "
"0","  assay_unique_kmers <- "
"0","    mg |> "
"0","    select(sample_id, strain, unique_kmers) |> "
"0","    pivot_wider(names_from = sample_id, values_from = unique_kmers) |> "
"0","    as.data.frame() |> "
"0","    column_to_rownames(""strain"")"
"0","  "
"0","  se_coldata <- "
"0","    mg |> "
"0","    select(sample_id, barcode, shared_kmers) |> "
"0","    distinct() |> "
"0","    as.data.frame() "
"0","  "
"0","  se_rowdata <- "
"0","    mg |> "
"0","    select(strain) |> "
"0","    distinct() |> "
"0","    left_join("
"0","      LBP_strain_info,"
"0","      by = join_by(strain == strain_id)"
"0","    ) "
"0","  "
"0","  SummarizedExperiment::SummarizedExperiment("
"0","    assays = list(prop_of_Lc = assay_prop_of_Lc, unique_kmers = assay_unique_kmers),"
"0","    rowData = se_rowdata,"
"0","    colData = se_coldata"
"0","  )"
"0","}"
"0",""
"0",""
