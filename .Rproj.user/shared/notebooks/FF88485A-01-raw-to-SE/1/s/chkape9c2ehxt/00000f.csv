"0",""
"0","phyloseq_to_SE <- function(physeq){"
"0","  "
"0","  sample_info <- "
"0","    physeq@sam_data |>"
"0","    as.data.frame() |> "
"0","    set_class(""data.frame"") |> "
"0","    rownames_to_column(""barcode"") |> "
"0","    as_tibble() |> "
"0","    mutate(sample_id = str_c(pid, ""_"", visit_code))"
"0",""
"0","  counts <- physeq@otu_table |> as.data.frame() |> set_class(""data.frame"")"
"0","  if (!phyloseq::taxa_are_rows(physeq)) counts <- counts |> t()"
"0","  counts <- counts |> set_colnames(sample_info$sample_id)"
"0","  rel <- t(t(counts)/colSums(counts)) |> as.data.frame()"
"0","  "
"0","  SummarizedExperiment::SummarizedExperiment("
"0","    assays = list(ASV_counts = counts, ASV_prop = rel),"
"0","    rowData = physeq@tax_table |> as.data.frame() |> set_class(""data.frame""),"
"0","    colData = sample_info |> as.data.frame() |> column_to_rownames(""sample_id"")"
"0","  )"
"0","}"
"0",""
